
<div th:fragment="html">
    <script>
        $(function(){
            var data4Vue = {
                uri:'http://127.0.0.1:8031/api-products/products',
                beans: [],
                bean: { id: 0, name: ''},
                pagination:{},
                file: null,
                nowUser: {id: 0, name: ''},
                size: 5
            };

            //ViewModel
            var vue = new Vue({
                el: '#workingArea',
                data: data4Vue,
                mounted:function(){ //mounted　表示这个 Vue 对象加载成功了
                    this.list(0);
                },
                methods: {

                    list:function(start){
                        var url =  this.uri+ "?start="+start+"&size="+this.size;
                        window.console.log("产品列表开始加载数据");
                        axios.get(url).then(function(response) {
                            vue.pagination = response.data;
                            vue.beans = response.data.content;
                            window.console.log("beans = "+vue.beans);
                        });
                        window.console.log("top列表开始处理");
                        var nameUrl ="http://127.0.0.1:8031/api-user/userName";
                        axios.get(nameUrl).then(function(response) {
                            vue.nowUser = response.data;//传了整个user
                            window.console.log("Nowusername= "+vue.nowUser.name);
                        });
                    },
                    showDetails: function(product){
                        var id = product.id;
                        $("#ProdutDetails"+id).show();///------
                    },
                    hideDetails: function(product){
                        var id = product.id;
                        $("#ProdutDetails"+id).hide();///------
                    },
                    jump: function(page){
                        jump(page,vue); //定义在adminHeader.html 中
                    },
                    jumpByNumber: function(start){
                        jumpByNumber(start,vue);
                    },
                    setSize:  function (size) {
                        this.size=size;
                        vue.list(0);
                    }
                    ,
                    pLike:  function (id) {
                        window.console.log('开始喜欢 ')
                        var url = this.uri+"/pLike/"+id;
                        axios.post(url).then(function(response){
                            if(0!=response.data.length){
                                alert(response.data);
                            }
                            else{
                                vue.list(0);
                                $("#ProdutLike"+id).hide();
                                $("#ProdutUnlike"+id).show();

                            }
                        });
                    },
                    pUnlike:  function (id) {
                        window.console.log('开始不喜欢  ');
                        var url = this.uri+"/pUnlike/"+id;
                        axios.post(url).then(function(response){
                            if(0!=response.data.length){
                                alert(response.data);
                            }
                            else{
                                vue.list(0);
                                $("#ProdutUnlike"+id).hide();
                                $("#ProdutLike"+id).show();

                            }
                        });
                    },
                    pShield:  function (id) {
                        if(!checkShieldLink())
                            return;
                        window.console.log('开始屏蔽  ');
                        var url = this.uri+"/pShield/"+id;
                        axios.post(url).then(function(response){
                            if(0!=response.data.length){
                                alert(response.data);
                            }
                            else{
                                vue.list(0);
                                $("#ProdutOne"+id).hide();

                            }
                        });
                    },
                    pReport:  function (id) {
                        if(!checkReprrtLink())
                            return;
                        window.console.log('开始举报  ');
                        var url = "http://127.0.0.1:8031/api-reports/add/"+id;
                        axios.post(url).then(function(response){
                            var result = response.data;
                            if(result.code==0){
                                window.console.log('举报成功  ');
                                alert("举报成功");
                            }
                            else{
                                window.console.log('出错了');

                            }
                        });
                    }

                }

            });
            Vue.filter('formatDateFilter', function (value, formatString) {
                if(null==value)
                    return "";
                formatString = formatString || 'YYYY-MM-DD HH:mm:ss';
                return moment(value).format(formatString);
            });
        });

    </script>


    <title>NstWeb</title>
    <div class="container">
        <hr />
        <div class="row">
            <div class="col-xs-4 ">
                <font size="5" color="green">排行:</font>
                &nbsp;&nbsp;&nbsp;
                <a href="#">
                    <font size="4" color="blue">日</font>
                </a>
                &nbsp;
                <a href="#">
                    <font size="4" color="blue">周</font>
                </a>
                &nbsp;
                <a href="#">
                    <font size="4" color="blue">月</font>
                </a>
                &nbsp;
                <a href="#">
                    <font size="4" color="blue">总</font>
                </a>
            </div>
            <div class="col-xs-4 ">&nbsp;</div>
            <div class="col-xs-4 ">&nbsp;</div>
        </div>

    </div>
    <template v-for="bean in beans ">
        <tr>
            <hr />
            <div :id="'ProdutOne'+bean.id" >
                <div class="container">
                    <div class="row">
                        <div class="col-xs-3 ">&nbsp;</div>
                        <div class="col-xs-2 " >
                            <font size="5" color="blue">{{bean.user.name}}</font>
                        </div>
                        <div class="col-xs-1"><font size="4" >{{bean.title}}</font></div>
                        <div class="col-xs-1">&nbsp;</div>
                        <div class="col-xs-1">&nbsp;</div>
                        <div class="col-xs-1">&nbsp;</div>
                        <div class="col-xs-2 ">&nbsp;</div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-xs-2 ">&nbsp;</div>
                        <div class="col-xs-1">&nbsp;</div>
                        <div class="col-xs-6" style= "height: 583px" >
                            <a :href="'img/productFinish/'+bean.id+'.jpg'" :title="'风格化力度：'+bean.scale+'  风格化尺度：'+bean.weight+'  颜色保留：'+bean.colorRetain">
                                <img id="mainImg" :src="'img/productFinish/'+bean.id+'.jpg'">
                            </a>
                        </div>
                        <div class="col-xs-1">&nbsp;</div>
                        <div class="col-xs-2 ">&nbsp;</div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-xs-2 ">&nbsp;</div>
                        <div class="col-xs-4 ">
                            <img  align="right" :src="'img/productSource/'+bean.id+'.jpg'">
                        </div>
                        <div class="col-xs-4 ">
                            <img  align="left" :src="'img/template/'+bean.template.id+'.jpg'">
                        </div>
                        <div class="col-xs-2 ">&nbsp;</div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-xs-2 ">
                            &nbsp;
                        </div>
                        <div class="col-xs-1">
                            <button @click="showDetails(bean)" class="orderPageCheckOrderItems btn btn-primary btn-xs">查看评论</button>
                        </div>
                        <div class="col-xs-1"> <button @click="hideDetails(bean)" class="orderPageCheckOrderItems btn btn-primary btn-xs">收起</button></div>
                        <div class="col-xs-1"></div>
                        <div class="col-xs-1">
                            <a href="#nowhere"  @click="pLike(bean.id)" :id="'ProdutLike'+bean.id">
                                <font class="glyphicon glyphicon-heart-empty" size="4" color="black">喜欢</font>
                            </a>
                            <a href="#nowhere"  @click="pUnlike(bean.id)" :id="'ProdutUnlike'+bean.id" style="display:none;">
                                <font class="glyphicon glyphicon-heart" size="4" color="red">喜欢</font>
                            </a>
                        </div>

                        <div class="col-xs-2">
                            <a href="#nowhere">
                                <font class="glyphicon glyphicon-play" size="4" color="bul">以此风格渲染</font>
                            </a>
                        </div>
                        <div class="col-xs-1">
                            <button type="button" class="btn btn-warning btn-xs" @click="pShield(bean.id)">
                                <font class="glyphicon glyphicon-remove" size="3" color="black">屏蔽</font>
                            </button>
                        </div>
                        <div class="col-xs-1">
                            <a href="#nowhere" @click="pReport(bean.id)">
                                <font class="glyphicon glyphicon-exclamation-sign" size="4" color="black">举报</font>
                            </a>
                        </div>
                        <div class="col-xs-2 ">&nbsp;</div>
                    </div>
                </div>
            </div>

        </tr>
    </template>
</div>




